#ID,Description,Platforms,Command1,Expecited1,Command2,Expected2,Command3,Expected3,Command4,Expected4
1,Verify product download and installation,all,install(smbclient \\\\10.10.60.5\\share -U administrator centeris||Release_builds\Sapphire\7931\LWISE\||/root/),Install complete
2,Doaminjoin,all,domainjoin(/opt/likewise/bin/domainjoin-cli join --ou regression childa.parent2.likewiseqa.com administrator || centeris),SUCCESS
3,Verify registry key value for new policy,all,regshellstart(/opt/likewise/bin/regshell),not(No such file or directory)
4,Verify registry key value for new policy,all,cd HKEY_THIS_MACHINE,HKEY_THIS_MACHINE,ls,HKEY_THIS_MACHINE
4,Verify registry key value for new policy,all,cd Policy\Services\lsass\Parameters,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters,ls, EnableEventlog             REG_DWORD       0x00000001 (1) &  LogNetworkConnectionEvents REG_DWORD       0x00000001 (1)
6,Verify registry key value for new \Policy,all,cd  \Policy\Services\lsass\Parameters\PAM,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\PAM,ls,"LogLevel            REG_SZ          ""error"" &  UserNotAllowedError REG_SZ          ""Unable to logon user due to an allow logon rights restriction"""
7,Verify registry key value for new \Policy,all,cd  \Policy\Services\lsass\Parameters\Providers\Local,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\Local,ls,"CreateHomeDir      REG_DWORD       0x00000001 (1) & HomeDirPrefix      REG_SZ          ""/home"" &  HomeDirTemplate    REG_SZ          ""%H/local/%D/%U"""
8,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\Local,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\Local,ls,"  HomeDirUMask       REG_SZ          ""022"" & LoginShellTemplate REG_SZ          ""/bin/sh"" &   SkeletonDirs       REG_SZ          ""/etc/skel"""
9,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"AssumeDefaultDomain           REG_DWORD       0x00000001 (1) &   CacheEntryExpiry              REG_DWORD       0x00003840 (14400) & CellSupport                   REG_SZ          ""full"""
10,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"CreateHomeDir                 REG_DWORD       0x00000001 (1) & CreateK5Login                 REG_DWORD       0x00000001 (1) & HomeDirPrefix                 REG_SZ          ""/home/local"""
11,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"HomeDirPrefix                 REG_SZ          ""/home/local"" & HomeDirTemplate               REG_SZ          ""%H/local/%D/%U"" & HomeDirUMask                  REG_SZ          ""022"""
12,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"LoginShellTemplate            REG_SZ          ""/bin/sh"" & MachinePasswordLifespan       REG_DWORD       0x00000001 (1) & NssEnumberationEnabled        REG_DWORD       0x00000000 (0)"
13,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"NssGroupMembersQueryCacheOnly REG_DWORD       0x00000001 (1) & NssUserMembersQueryCacheOnly  REG_DWORD       0x00000000 (0) & RefreshUserCredentials        REG_DWORD       0x00000001 (1)"
14,Verify registry key value for new policy,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"SkeletonDirs                  REG_SZ          ""/etc/skel"" & SpaceReplacement              REG_SZ          ""^"" & SyncSystemTime                REG_DWORD       0x00000000 (0)"
15,Verify registry key value for new policy,all,cd  \Policy\Services\gpagent\Parameters, HKEY_THIS_MACHINE\Policy\Services\gpagent\Parameters,ls,ComputerPolicyRefreshInterval    REG_DWORD       0x00000708 (1800) &  EnableEventLog                   REG_DWORD       0x00000001 (1) &  MonitorSudoers                   REG_DWORD       0x00000001 (1)
16,Verify registry key value for new policy,all,cd  \Policy\Services\gpagent\Parameters, HKEY_THIS_MACHINE\Policy\Services\gpagent\Parameters,ls,UserPolicyLoopbackProcessingMode REG_DWORD       0x00000000 (0) & UserPolicyRefreshInterval        REG_DWORD       0x00000708 (1800)
17,Verify registry key value for new policy,all,cd  \Policy\Services\eventlog\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventlog\Parameters,ls,"AllowDeleteTo        REG_SZ          ""CHILDA\\reguser"" & AllowReadTo          REG_SZ          ""CHILDA\\reguser"" & AllowWriteTo         REG_SZ          ""CHILDA\\reguser"""
18,Verify registry key value for new policy,all,cd  \Policy\Services\eventlog\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventlog\Parameters,ls,MaxDiskUsage         REG_DWORD       0x06400000 (104857600) & MaxEventLifespan     REG_DWORD       0x0000005a (90) & MaxNumEvents         REG_DWORD       0x000186a0 (100000)
19,Verify registry key value for new policy,all,cd  \Policy\Services\eventfwd\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventfwd\Parameters,ls,"Collector          REG_SZ          ""10.10.60.7"" & CollectorPrincipal REG_SZ          ""parent"""
20,Verify registry key value for new policy,all,cd  \Policy\Services\lwedsplugin\Parameters,HKEY_THIS_MACHINE\Policy\Services\lwedsplugin\Parameters,ls,"AllowAdministrationBy           REG_SZ          ""CHILDA\\reguser"" & EnableForceHomedirOnStartupDisk REG_DWORD       0x00000001 (1) & EnableMergeAdmins               REG_DWORD       0x00000001 (1)"
21,Verify registry key value for new policy,all,cd  \Policy\Services\lwedsplugin\Parameters,HKEY_THIS_MACHINE\Policy\Services\lwedsplugin\Parameters,ls," EnableMergeModeMCX              REG_DWORD       0x00000001 (1) & UncProtocolForHomeLocation      REG_SZ          ""smb"" & UseADUncForHomeLocation         REG_DWORD       0x00000001 (1)"
22,Verify registry key value for new policy,all, regshellstop()
23,Checking MOTD policy,all, cat /etc/motd,Message from RegressionGPO
24,Checking Login prompt policy policy,all,cat /etc/issue,Message from RegressionGPO
25,Verifying syslog policy,all,cat /etc/syslog.conf,*.*  & /tmp/systemlogs
26,Verifying syslog policy,all,cat /etc/rsyslog.conf,*.*  & /tmp/systemlogs
27,Verifying syslog policy,all,cat /etc/syslog-ng/syslog.conf,*.*  & /tmp/systemlogs
28,Verifying logrotate policy,all,cat /etc/logrotate.conf, daily &  extension ..log &    olddir /tmp/oldlogs &    rotate 7 &   size=7k
29,"Verifying File,directory and symbolic link creation policies",all,cd /tmp,,ls,Directory
30,"Verifying File,directory and symbolic link creation policies",all,cd /tmp,,ls,Sti_Trace.log
31,"Verifying File,directory and symbolic link creation policies",all,cd /tmp,,ls,symboliclink
32,"Verifying File,directory and symbolic link creation policies",all,cd /tmp,,ls,Adcommand
33,To verify that the script Policy set in the AD is executed,all,cat /tmp/script-result,Linux Running AD Script 1
34,To verify the cronjob policy,all,cd /tmp,,ls,cronpolicy-bvt
35,To Verify the network settings policy,all,cat /etc/resolv.conf,parent2.likewiseqa.com & 10.10.60.7 & 10.10.60.8
36,To verify the sudoers policy,all,userlogin(childa\\reguser||span1234),,pwd,/home/CHILDA/reguser,sudo /opt/likewise/bin/domainjoin-cli query  ,password,span1234,"Name = ubuntu32b810 & Domain = CHILDA.PARENT2.LIKEWISEQA.COM & Distinguished Name = CN=UBUNTU32B810,OU=Regression,DC=childa,DC=parent2,DC=likewiseqa,DC=com"
37,To verify the sudoers policy,all,userlogin(childa\\reguser1||span1234),,pwd,/home/CHILDA/reguser1,sudo /opt/likewise/bin/domainjoin-cli query  ,password,span1234,CHILDA\reguser1 is not in the sudoers file.  This incident will be reported.
38,Verify key values for undefined policies,all, domainleave(/opt/likewise/bin/domainjoin-cli leave administrator centeris),SUCCESS
39,Domainjoin to to verify that key values are removed when the client joins to a OU where GPO has none of the policies are defined,all,domainjoin(/opt/likewise/bin/domainjoin-cli join --ou regundef childa.parent2.likewiseqa.com administrator || centeris),SUCCESS
40,Verify registry key value for undef OU,all,regshellstart(/opt/likewise/bin/regshell),not(No such file or directory)
41,Verify registry key value for undef OU,all,cd HKEY_THIS_MACHINE,HKEY_THIS_MACHINE,ls,HKEY_THIS_MACHINE & HKEY_THIS_MACHINE\Services
42,Stopping Regshell,all, regshellstop()
43,Leaving regundef OU and domain,all, domainleave(/opt/likewise/bin/domainjoin-cli leave administrator centeris)
44,Doaminjoin to a child ou verify that registry key is correctly updated with new key value from parent GPO and child GPO .(To check the inheritance feature),all,domainjoin(/opt/likewise/bin/domainjoin-cli join --ou regression//reginherit childa.parent2.likewiseqa.com administrator || centeris),SUCCESS
45,Starting the regshell,all,regshellstart(/opt/likewise/bin/regshell),not(No such file or directory)
46,Verify registry key value when inheritance in place,all,cd HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\PAM,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\PAM,ls,"LogLevel            REG_SZ          ""error"" &  UserNotAllowedError REG_SZ          ""Unable to logon user due to an allow logon rights restriction"""
47,Verify registry key value when inheritance in place,all,cd   \Policy\Services\lsass\Parameters\Providers\Local,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\Local,ls,"CreateHomeDir      REG_DWORD       0x00000001 (1) & HomeDirPrefix      REG_SZ          ""/home"" &  HomeDirTemplate    REG_SZ          ""%H/local/%D/%U"""
48,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\Local,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\Local,ls,"  HomeDirUMask       REG_SZ          ""022"" & LoginShellTemplate REG_SZ          ""/bin/sh"" &   SkeletonDirs       REG_SZ          ""/etc/skel"""
49,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"AssumeDefaultDomain           REG_DWORD       0x00000001 (1) &   CacheEntryExpiry              REG_DWORD       0x00003840 (14400) & CellSupport                   REG_SZ          ""full"""
50,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"CreateHomeDir                 REG_DWORD       0x00000001 (1) & CreateK5Login                 REG_DWORD       0x00000001 (1) & HomeDirPrefix                 REG_SZ          ""/home/local"""
52,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"LoginShellTemplate            REG_SZ          ""/bin/sh"" & MachinePasswordLifespan       REG_DWORD       0x00000001 (1) & NssEnumberationEnabled        REG_DWORD       0x00000000 (0)"
53,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,NssGroupMembersQueryCacheOnly REG_DWORD       0x00000001 (1) & NssUserMembersQueryCacheOnly  REG_DWORD       0x00000000 (0) & RefreshUserCredentials        REG_DWORD       0x00000001 (1)
54,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lsass\Parameters\Providers\ActiveDirectory,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\Providers\ActiveDirectory,ls,"SkeletonDirs                  REG_SZ          ""/etc/skel"" & SpaceReplacement              REG_SZ          ""^"" & SyncSystemTime                REG_DWORD       0x00000000 (0) & TrimUserMembership            REG_DWORD       0x00000001 (1)"
55,Verify registry key value when inheritance in place,all,cd  \Policy\Services\gpagent\Parameters, HKEY_THIS_MACHINE\Policy\Services\gpagent\Parameters,ls,"ComputerPolicyRefreshInterval    REG_DWORD       0x00000708 (1800) &  EnableEventLog                   REG_DWORD       0x00000001 (1) &  MonitorSudoers                   REG_DWORD       0x00000001 (1)"
56,Verify registry key value when inheritance in place,all,cd  \Policy\Services\gpagent\Parameters, HKEY_THIS_MACHINE\Policy\Services\gpagent\Parameters,ls,UserPolicyLoopbackProcessingMode REG_DWORD       0x00000000 (0) & UserPolicyRefreshInterval        REG_DWORD       0x00000708 (1800)
57,Verify registry key value when inheritance in place,all,cd  \Policy\Services\eventlog\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventlog\Parameters,ls,"AllowDeleteTo        REG_SZ          ""CHILDA\\reguser1"" & AllowReadTo          REG_SZ          ""CHILDA\\reguser1"" & AllowWriteTo         REG_SZ          ""CHILDA\\reguser1"""
58,Verify registry key value when inheritance in place,all,cd  \Policy\Services\eventlog\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventlog\Parameters,ls,MaxDiskUsage         REG_DWORD       0x06400000 (104857600) & MaxEventLifespan     REG_DWORD       0x0000005a (90) & MaxNumEvents         REG_DWORD       0x000186a0 (100000) & RemoveEventsAsNeeded REG_DWORD       0x00000001 (1)
59,Verify registry key value when inheritance in place,all,cd  \Policy\Services\eventfwd\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventfwd\Parameters,ls,"Collector          REG_SZ          ""10.10.60.7"" & CollectorPrincipal REG_SZ          ""parent"""
60,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lwedsplugin\Parameters,HKEY_THIS_MACHINE\Policy\Services\lwedsplugin\Parameters,ls,"AllowAdministrationBy           REG_SZ          ""CHILDA\\reguser""  EnableForceHomedirOnStartupDisk REG_DWORD       0x00000001 (1)  EnableMergeAdmins               REG_DWORD       0x00000001 (1)"
61,Verify registry key value when inheritance in place,all,cd  \Policy\Services\lwedsplugin\Parameters,HKEY_THIS_MACHINE\Policy\Services\lwedsplugin\Parameters,ls," EnableMergeModeMCX              REG_DWORD       0x00000001 (1)  UncProtocolForHomeLocation      REG_SZ          ""smb""  UseADUncForHomeLocation         REG_DWORD       0x00000001 (1)"
62,Stopping Regshell,all, regshellstop()
63,Leaving regression\reginherit OU and domain,all,domainleave(/opt/likewise/bin/domainjoin-cli leave administrator centeris)
64,Doaminjoin to verify that key values are  modified according to the settings in the GPO where inheritance is blocked for the OU,all,domainjoin(/opt/likewise/bin/domainjoin-cli join --ou regression//reginherit_blocked childa.parent2.likewiseqa.com administrator || centeris),SUCCESS
65,Starting the regshell,all,regshellstart(/opt/likewise/bin/regshell),not(No such file or directory)
66,Verify registry key value when inheritance is blocked,all,cd HKEY_THIS_MACHINE\Policy\Services,HKEY_THIS_MACHINE\Policy\Services,ls,HKEY_THIS_MACHINE\Policy\Services & HKEY_THIS_MACHINE\Policy\Services\lsass & HKEY_THIS_MACHINE\Policy\Services\eventfwd & HKEY_THIS_MACHINE\Policy\Services\eventlog &not (HKEY_THIS_MACHINE\Policy\Services\gpagent) &not (HKEY_THIS_MACHINE\Policy\Services\lwedsplugin)
67,Verify registry key value when inheritance is blocked,all,cd   \Policy\Services\lsass\Parameters\,HKEY_THIS_MACHINE\Policy\Services\lsass\Parameters\,ls, EnableEventlog             REG_DWORD       0x00000001 (1) & LogNetworkConnectionEvents REG_DWORD       0x00000001 (1)
68,Verify registry key value when inheritance is blocked,all,cd  \Policy\Services\eventlog\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventlog\Parameters,ls,"AllowDeleteTo REG_SZ          ""CHILDA\\reggroup""  & AllowReadTo   REG_SZ          ""CHILDA\\reggroup"" &   AllowWriteTo  REG_SZ          ""CHILDA\\reggroup"""
69,Verify registry key value when inheritance is blocked,all,cd  \Policy\Services\eventfwd\Parameters,HKEY_THIS_MACHINE\Policy\Services\eventfwd\Parameters,ls,"Collector          REG_SZ          ""10.10.60.6"" &   CollectorPrincipal REG_SZ          ""parent2"""
62,Stopping Regshell,all, regshellstop()
70,Leaving regression\reginherit_blocked OU and domain,all, domainleave(/opt/likewise/bin/domainjoin-cli leave administrator centeris),SUCCESS
